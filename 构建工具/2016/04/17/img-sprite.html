<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
    <title>合并图片</title>
    <link rel="shortcut icon" href="/assets/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/assets/css/fonts.css?v=20160720" />
    <link rel="stylesheet" type="text/css" href="/assets/css/pygments.css?v=20160720">
    <link rel="stylesheet" type="text/css" href="/assets/css/index.css?v=20160720" />    
</head>
<body class="font-hei">
    <div id="logo">
    <a href="/">cobish.github.io</a>
</div>
    <div class="article">
    <h3 class="article-title">合并图片</h3>
    <p class="article-time">2016-04-17， 浏览量：<span data-hk-page="current"> - </span> 次</p>
    <div class="article-desc article-content"><p>一直在寻找更优的方式来解决合并图片问题。这种方式需要满足几个要求：首先它能够将一个或多个 css 文件里引用到的图片合并成一张图片，接着它要能对应地修改 css 里图片的路径，最后它还要能方便维护修改，即如果我想替换图片或增加图片，它能够重新合并图片。</p>

<p>过去都是设计师把所有的小图标合并成一张大的图片，这需要我们不断地去修改 background-position 来调整小图片的显示。这种方式的好处就是前端不需要去合并图片，直接图片拿来使用即可。但它也有一些缺点，图片并不是以最优的方式合并，还可以合并成大小更小的图片；还有就是大图片里的小图标需要更换或是添加的时候，都必须让设计师找到原图进行更改，并且得保证原来的小图标位置不能改动，不然 css 代码也需要随之改动。</p>

<p>后来，网上有很多工具可以帮忙合并图片。尝试过了很多，大致都是你把要合并到一起的图片移到一个框内，然后自己去调整位置。实际上这种做法跟设计师的做法没区别，只不过是前端自己来完成而已，最后还是需要前端自己去调整 css 代码。后来又出现了一些线上的工具，例如<a href="http://alloyteam.github.io/gopng/">「GoPng」</a>。这些工具会根据一定的算法去合并，并且会把 css 代码展示出来给你复制，不需要前端去手动书写引用图片的代码。但是，它们也有缺点，还是不方便更改，一旦图片做了更改，css 代码也会随之更改。</p>

<p>最后，构建工具让我找到了较优的解决方案。可以用到的插件是<a href="https://www.npmjs.com/package/grunt-css-sprite">「grunt-css-sprite」</a>或<a href="https://www.npmjs.com/package/gulp-css-spritesmith">「gulp-css-spritesmith」</a>。主要策略是有两个目录，一个是保存开发代码的 src 目录，一个是用于上线的 dist 目录。src 目录下用到的都是没有合并的小图片，css 代码引用到的也是各个图片。dist 目录下则是通过插件把图片都合并了，并修改了 css 里的代码。开发期间就使用未合并的图片，上线期间则通过打包工具使用已合并的图片。最后，目录如下：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">├─ dist/
    ├─ css/
        └─ login.css
    └─ images/
        └─ icon_sprite.css
└─ src/
    ├─ css/
        └─ login.css
    └─ images/
        └─ login
            ├─ icon_1.png
            ├─ icon_2.png
            └─ icon_3.png
</code></pre></div></div>
</div>
<div id="ds" class="article">
    <!-- 多说评论框 -->
    <div class="ds-thread" data-thread-key="_posts/2016-04-17-img-sprite.md" data-title="合并图片" data-url="/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/2016/04/17/img-sprite.html"></div>
</div>

<!-- 浏览量 -->
<script src="https://cdn1.lncld.net/static/js/av-mini-0.6.10.js"></script>
<script src="http://jerry-cdn.b0.upaiyun.com/hit-kounter/hit-kounter-lc-0.2.0.js"></script>
<script type="text/javascript">
    var duoshuoQuery = {short_name:"cobish"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>

    <script>
if (document.domain.indexOf('github.io') > -1) {
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?84602bc3713ca2aeb0258c55adf6a333";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
}
</script>

</body>
</html>

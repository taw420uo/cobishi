<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
    <title>jQuery load 局部刷新</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/index.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/css/prettify.css" media="screen" />
</head>
<body>
    <div id="logo">
    <a href="/">cobish.github.io</a>
</div>
    <div class="article">
    <h3 class="article-title">jQuery load 局部刷新</h3>
    <p class="article-time">Jul 04, 2015</p>
    <div class="article-desc article-content"><h2 id="section">用法</h2>

<ul>
  <li><a href="http://www.w3school.com.cn/jquery/ajax_load.asp" target="_blank">jQuery ajax - load() 方法</a></li>
</ul>

<h2 id="section-1">运行环境</h2>

<p>jQuery的<code>load()</code>方法跟<code>jQuery AJAX</code>一样都需要用到服务器端来支持，所以你会发现如果你只是写了静态页面并直接双击运行，浏览器会给你一个<code>XMLHttpRequest cannot load</code>的错误，你需要把代码放在服务器上才能运行。</p>

<h2 id="section-2">深入使用</h2>

<p>如果单单是使用<code>load()</code>方法，你就会发现，在ajax请求中，不能更新地址栏，地址栏上的“前进”和“后退”按钮就失效了,带来了另外一种糟糕的用户体验。</p>

<p><br /></p>

<p>解决方案有三种，分别是（详情使用请移步：<a href="http://www.cnblogs.com/xumingxiang/archive/2012/11/25/2787530.html" target="_blank">Ajax保留浏览器历史的解决方案</a>）：</p>

<ul>
  <li>使用<code>window.Onhashchange</code>事件；</li>
  <li>使用<code>jQuery.History.js</code>第三方插件；</li>
  <li>使用<code>jquery.ba-hashchange.js</code>第三方插件。</li>
</ul>

<h2 id="section-3">使用方案</h2>

<p>由于我需要兼容<code>ie6</code>以上的浏览器，加上<code>jQuery.History.js</code>不再维护，所以我选择第三种方案来解决以上问题。期间我遇到了以下问题：</p>

<ul>
  <li>在jquery 1.9以上版本中，控制台会提示<code>msie</code>找不到的问题，原因是<code>browser</code>属性已经被移除</li>
</ul>

<p><br /></p>

<p>解决方法：</p>

<ul>
  <li>官方建议使用 <a href="http://modernizr.com/" target="_blank">Modernizr</a> 库</li>
  <li>在引入 jquery 和 jquery.ba-hashchange.js 代码期间引入以下js代码</li>
</ul>

<pre class="prettyprint linenums">
jQuery.browser={};(function(){jQuery.browser.msie=false; jQuery.browser.version=0;if(navigator.userAgent.match(/MSIE ([0-9]+)./)){ jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1;}})();
</pre>
</div>
</div>
    <script type="text/javascript" src="/assets/js/prettify.js"></script>
    <script type="text/javascript">
        prettyPrint();
    </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
    <title>js模板引擎</title>
    <link rel="shortcut icon" href="/assets/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/assets/css/fonts.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/css/index.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/css/prettify.css" media="screen" />
</head>
<body class="font-hei">
    <div id="logo">
    <a href="/">cobish.github.io</a>
</div>
    <div class="article">
    <h3 class="article-title">js模板引擎</h3>
    <p class="article-time">October 24, 2015</p>
    <div class="article-desc article-content"><p>在接触到js模板引擎之前，我都是使用字符串拼接的方式来操作html的标签。例如通过Ajax获取到以下一个对象，把它拼接起来显示到网页上。用久了这一种方式便会发现它的缺点。代码看起来不美观，js代码里包含着大量的html代码；代码不易维护，html标签没有合适的缩进。如果再if等判断语句只会让拼接代码更加的复杂。</p>

<pre class="prettyprint linenums">
var data = {
    title: '四大名著',
    list: ['西游记', '三国演义', '水浒传', '红楼梦']
};

// 拼装html代码块
var html = '';
html += '&lt;h1&gt;' + data.title + '&lt;/h1&gt;';
html += '&lt;ul&gt;';

for ( var i = 0; i &lt; data.list.length; i++ ) {
    html += '&lt;li&gt;索引 ' + ( i + 1 ) + ' : ' + data.list[i] + '&lt;/li&gt;';
}

html += '&lt;/ul&gt;';
document.getElementById('content').innerHTML = html;
</pre>

<p><br /></p>

<p>后来从<a href="http://www.zhangxinxu.com/wordpress/2012/09/javascript-html-json-template/" target="_blank">张鑫旭博客</a>中学习到另一种处理方法，即将html代码放在一个隐藏的标签里，然后通过js获取到并正则匹配进行替换，最后把替换后的代码块显示在网页上。js模板引擎大致都是类似原理。</p>

<p><br /></p>

<p>当然也有现成的模板引擎帮我们解决以上的种种问题，例如<a href="https://github.com/aui/artTemplate" target="_blank">artTemplate</a>。或者是<a href="http://handlebarsjs.com/" target="_blank">Handlebars.js</a>，这里有一份Handlebars.js的<a href="http://segmentfault.com/a/1190000000342636?from=androidqq" target="_blank">中文文档</a>和一份<a href="http://www.cnblogs.com/iyangyuan/archive/2013/12/12/3471227.html" target="_blank">使用教程</a>。以下是artTemplate的一个例子：</p>

<pre class="prettyprint linenums">
&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;
&lt;ul&gt;
    &#123;&#123;each list as value i&#125;&#125;
        &lt;li&gt;索引 &#123;&#123;i + 1&#125;&#125; ：&#123;&#123;value&#125;&#125;&lt;/li&gt;
    &#123;&#123;/each&#125;&#125;
&lt;/ul&gt;

&lt;script type="text/javascript" src="template.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    var data = {
        title: '四大名著',
        list: ['西游记', '三国演义', '水浒传', '红楼梦']
    };

    var html = template('test', data);
    document.getElementById('content').innerHTML = html;
&lt;/script&gt;
</pre>
</div>
</div>

<a id="showDs">
    显示评论
</a>

<div id="ds" class="article">
    <!-- 多说评论框 -->
    <div class="ds-thread" data-thread-key="_posts/2015-10-24-js-template.md" data-title="js模板引擎" data-url="/%E5%89%8D%E7%AB%AF/2015/10/24/js-template.html"></div>
</div>

<script type="text/javascript">
    var duoshuoQuery = {short_name:"cobish"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();

    var showDs = document.getElementById('showDs'),
        ds = document.getElementById('ds');

    showDs.onclick = function() {
        showDs.style.display = 'none';
        ds.style.display = 'block';
    };
</script>
    <script type="text/javascript" src="/assets/js/prettify.js"></script>
    <script type="text/javascript">
        prettyPrint();
    </script>
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?84602bc3713ca2aeb0258c55adf6a333";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</body>
</html>

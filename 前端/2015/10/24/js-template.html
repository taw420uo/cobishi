<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
    <title>js模板引擎</title>
    <link rel="shortcut icon" href="/assets/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/assets/css/fonts.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/index.css" media="screen" />    
</head>
<body class="font-hei">
    <div id="logo">
    <a href="/">cobish.github.io</a>
</div>
    <div class="article">
    <h3 class="article-title">js模板引擎</h3>
    <p class="article-time">2015-10-24</p>
    <div class="article-desc article-content"><p>在接触到js模板引擎之前，我都是使用字符串拼接的方式来操作html的标签。例如通过Ajax获取到以下一个对象，把它拼接起来显示到网页上。用久了这一种方式便会发现它的缺点。代码看起来不美观，js代码里包含着大量的html代码；代码不易维护，html标签没有合适的缩进。如果再if等判断语句只会让拼接代码更加的复杂。</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="lineno"> 2</span>     <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;四大名著&#39;</span><span class="p">,</span>
<span class="lineno"> 3</span>     <span class="nx">list</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;西游记&#39;</span><span class="p">,</span> <span class="s1">&#39;三国演义&#39;</span><span class="p">,</span> <span class="s1">&#39;水浒传&#39;</span><span class="p">,</span> <span class="s1">&#39;红楼梦&#39;</span><span class="p">]</span>
<span class="lineno"> 4</span> <span class="p">};</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="c1">// 拼装html代码块</span>
<span class="lineno"> 7</span> <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 8</span> <span class="nx">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h1&gt;&#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s1">&#39;&lt;/h1&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 9</span> <span class="nx">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;ul&gt;&#39;</span><span class="p">;</span>
<span class="lineno">10</span> 
<span class="lineno">11</span> <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">12</span>     <span class="nx">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;li&gt;索引 &#39;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&lt;/li&gt;&#39;</span><span class="p">;</span>
<span class="lineno">13</span> <span class="p">}</span>
<span class="lineno">14</span> 
<span class="lineno">15</span> <span class="nx">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/ul&gt;&#39;</span><span class="p">;</span>
<span class="lineno">16</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span></code></pre></div>

<p><br /></p>

<p>后来从<a href="http://www.zhangxinxu.com/wordpress/2012/09/javascript-html-json-template/">张鑫旭博客</a>中学习到另一种处理方法，即将html代码放在一个隐藏的标签里，然后通过js获取到并正则匹配进行替换，最后把替换后的代码块显示在网页上。js模板引擎大致都是类似原理。</p>

<p><br /></p>

<p>当然也有现成的模板引擎帮我们解决以上的种种问题，例如<a href="https://github.com/aui/artTemplate">artTemplate</a>，下面有一段小例子可以拿来与上面的代码对比，然后细细地品味出它们之前的不同。模板引擎我接触到的还有<a href="http://handlebarsjs.com/">Handlebars.js</a>，这里有一份Handlebars.js的<a href="http://segmentfault.com/a/1190000000342636?from=androidqq">中文文档</a>和一份<a href="http://www.cnblogs.com/iyangyuan/archive/2013/12/12/3471227.html">使用教程</a>。</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="lineno"> 1</span> <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;template.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="lineno"> 2</span> <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="lineno"> 3</span>     <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="lineno"> 4</span>         <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;四大名著&#39;</span><span class="p">,</span>
<span class="lineno"> 5</span>         <span class="nx">list</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;西游记&#39;</span><span class="p">,</span> <span class="s1">&#39;三国演义&#39;</span><span class="p">,</span> <span class="s1">&#39;水浒传&#39;</span><span class="p">,</span> <span class="s1">&#39;红楼梦&#39;</span><span class="p">]</span>
<span class="lineno"> 6</span>     <span class="p">};</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>     <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">template</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
<span class="lineno"> 9</span>     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span>
<span class="lineno">10</span> <span class="nt">&lt;/script&gt;</span></code></pre></div>
</div>
</div>

<a id="showDs">
    显示评论
</a>

<div id="ds" class="article">
    <!-- 多说评论框 -->
    <div class="ds-thread" data-thread-key="_posts/2015-10-24-js-template.md" data-title="js模板引擎" data-url="/%E5%89%8D%E7%AB%AF/2015/10/24/js-template.html"></div>
</div>

<script type="text/javascript">
    var duoshuoQuery = {short_name:"cobish"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();

    var showDs = document.getElementById('showDs'),
        ds = document.getElementById('ds');

    showDs.onclick = function() {
        showDs.style.display = 'none';
        ds.style.display = 'block';
    };
</script>
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?84602bc3713ca2aeb0258c55adf6a333";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</body>
</html>
